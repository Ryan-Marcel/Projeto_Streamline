@using Projeto_Dotnet8.Models
@model IEnumerable<Projeto_Dotnet8.Models.ComputadorModels>

@{
    ViewData["Title"] = "Listar Solicitações";
}

<head>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="~/css/listar.css" />
    <link rel="stylesheet" href="~/css/header.css" />

</head>

<header>

</header>

<body>


    <partial name="_Header" />


    <div class="titulo">
        <div class="bg1">
            <h1>Notificações</h1>
        </div>
        <div class="bg2"></div>
    </div>

    <section class="container">

        <ul class="computers-list">
            @* Laço de repetição para que todos os computadores criados sejam alcançados pelo código *@
            @if (Model != null && Model.Any())
            {
                foreach (ComputadorModels computador in Model)
                {

                    <li>
                        <div class="computer-header" onclick="toggleDropdown(this)">
                            <span>
                                @* Apresentação dos dados de cada Computador *@
                                <span class="status-circle status-ok"></span>
                                <p>
                                    <b>Nome:</b> @computador.Nome
                                    <b>ID:</b> @computador.ID <br>
                                    <b>Postado em:</b> @computador.DataPostagem.ToString("dd/MM/yyyy HH:mm")
                                </p>
                            </span>
                            <button class="dropdown-btn" tabindex="-1">
                            <img id="chevron-img-@computador.ID" src="/IMG/chevron.png" alt="">
                            </button>
                        </div>
                        <div class="dropdown-box">
                            @* Mensagem que cada computador retem *@
                            @if (computador.Mensagens != null && computador.Mensagens.Any())
                            {
                                foreach (var mensagem in computador.Mensagens)
                                {
                                    <textarea readonly>@mensagem.Texto</textarea>
                                }
                            }
                            else
                            {
                                <textarea readonly>Nenhuma mensagem cadastrada.</textarea>
                            }
                        </div>
                    </li>

                }
            }
        </ul>

        <a asp-controller="Principal" asp-action="Editar" id="editar">Editar</a>
        <a asp-controller="Principal" asp-action="IndexADM" id="secundario">Voltar</a>
    </section>

    <script>
function toggleDropdown(headerDiv) {
    var box = headerDiv.nextElementSibling;
    var img = headerDiv.querySelector('.dropdown-btn img');
    if (box.classList.contains('open')) {
        box.classList.remove('open');
        if (img) img.src = '/IMG/chevron.png';
    } else {
        box.classList.add('open');
        if (img) img.src = '/IMG/up-arrows.png';
    }
}
</script>

</body>